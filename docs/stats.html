

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pewanalytics.stats: Statistical Tools &mdash; pewanalytics 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pewanalytics.text: Text Tools" href="text.html" />
    <link rel="prev" title="Pew Analytics" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pewanalytics
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Statistical Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#clustering">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dimensionality-reduction">Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inter-rater-reliability">Inter-Rater Reliability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mutual-information">Mutual Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampling">Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pewanalytics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>pewanalytics.stats: Statistical Tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stats.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pewanalytics-stats-statistical-tools">
<h1>pewanalytics.stats: Statistical Tools<a class="headerlink" href="#pewanalytics-stats-statistical-tools" title="Permalink to this headline">¶</a></h1>
<p>In the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats</span></code> module, you’ll find a variety of statistical utilities for weighting, clustering, dimensionality reduction, and inter-rater reliability.</p>
<div class="section" id="clustering">
<h2>Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-pewanalytics.stats.clustering" title="pewanalytics.stats.clustering"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats.clustering</span></code></a> submodule contains several functions for extracting clusters from your data.</p>
<span class="target" id="module-pewanalytics.stats.clustering"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.clustering.compute_hdbscan_clusters" title="pewanalytics.stats.clustering.compute_hdbscan_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_hdbscan_clusters</span></code></a>(features[, …])</p></td>
<td><p>Uses HDBSCAN* to identify the best number of clusters and map each unit to one.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.clustering.compute_kmeans_clusters" title="pewanalytics.stats.clustering.compute_kmeans_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_kmeans_clusters</span></code></a>(features[, k, …])</p></td>
<td><p>Uses K-Means to cluster an arbitrary set of features.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pewanalytics.stats.clustering.compute_kmeans_clusters">
<code class="sig-name descname">compute_kmeans_clusters</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">k=10</em>, <em class="sig-param">return_score=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/clustering.html#compute_kmeans_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.clustering.compute_kmeans_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses K-Means to cluster an arbitrary set of features. This function expects input data where the rows are units     and columns are features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – TF-IDF sparse matrix or <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p></li>
<li><p><strong>k</strong> (<em>int</em>) – The number of clusters to extract</p></li>
<li><p><strong>return_score</strong> (<em>bool</em>) – If True, the function returns a tuple with the cluster     assignments and the silhouette score of the clustering; otherwise the function just returns a list of cluster     labels for each row. (Default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list with the cluster label for each row, or a tuple containing the     labels followed by the silhouette score of the K-Means model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.clustering</span> <span class="k">import</span> <span class="n">compute_kmeans_clusters</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># The iris dataset is a common example dataset included in scikit-learn with 3 main clusters</span>
<span class="c1"># Let&#39;s see if we can find them</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_kmeans_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">KMeans</span><span class="p">:</span> <span class="n">n_clusters</span> <span class="mi">3</span><span class="p">,</span> <span class="n">score</span> <span class="ow">is</span> <span class="mf">0.5576853964035263</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1</span>    <span class="mi">62</span>
<span class="mi">0</span>    <span class="mi">50</span>
<span class="mi">2</span>    <span class="mi">38</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.clustering.compute_hdbscan_clusters">
<code class="sig-name descname">compute_hdbscan_clusters</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">min_cluster_size=100</em>, <em class="sig-param">min_samples=1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/clustering.html#compute_hdbscan_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.clustering.compute_hdbscan_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses HDBSCAN* to identify the best number of clusters and map each unit to one. This function expects input data     where the rows are units and columns are features. Additional keyword arguments are passed to HDBSCAN. Check     out the official documentation for more: <a class="reference external" href="https://hdbscan.readthedocs.io/en/latest">https://hdbscan.readthedocs.io/en/latest</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – TF-IDF sparse matrix or <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p></li>
<li><p><strong>min_cluster_size</strong> (<em>int</em>) – int - minimum number of documents/units that can exist in a cluster.</p></li>
<li><p><strong>min_samples</strong> (<em>int</em>) – Minimum number of samples to draw (see HDBSCAN documentation for more)</p></li>
<li><p><strong>kwargs</strong> – Additional HDBSCAN parameters: <a class="reference external" href="https://hdbscan.readthedocs.io/en/latest/parameter_selection.html">https://hdbscan.readthedocs.io/en/latest/parameter_selection.html</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list with the cluster label for each row</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.clustering</span> <span class="k">import</span> <span class="n">compute_hdbscan_clusters</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_hdbscan_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">min_cluster_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">HDBSCAN</span><span class="p">:</span> <span class="n">n_clusters</span> <span class="mi">2</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1</span>    <span class="mi">100</span>
<span class="mi">0</span>     <span class="mi">50</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="dimensionality-reduction">
<h2>Dimensionality Reduction<a class="headerlink" href="#dimensionality-reduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-pewanalytics.stats.dimensionality_reduction" title="pewanalytics.stats.dimensionality_reduction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats.dimensionality_reduction</span></code></a> submodule contains functions for collapsing your data into underlying dimensions using methods like PCA and correspondence analysis.</p>
<span class="target" id="module-pewanalytics.stats.dimensionality_reduction"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.dimensionality_reduction.correspondence_analysis" title="pewanalytics.stats.dimensionality_reduction.correspondence_analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correspondence_analysis</span></code></a>(edges[, n])</p></td>
<td><p>Performs correspondence analysis on a set of features.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.dimensionality_reduction.get_lsa" title="pewanalytics.stats.dimensionality_reduction.get_lsa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lsa</span></code></a>(features[, feature_names, k])</p></td>
<td><p>Performs LSA on a set of features.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.dimensionality_reduction.get_pca" title="pewanalytics.stats.dimensionality_reduction.get_pca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pca</span></code></a>(features[, feature_names, k])</p></td>
<td><p>Performs PCA on a set of features.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pewanalytics.stats.dimensionality_reduction.get_pca">
<code class="sig-name descname">get_pca</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">feature_names=None</em>, <em class="sig-param">k=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/dimensionality_reduction.html#get_pca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.dimensionality_reduction.get_pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs PCA on a set of features. This function expects input data where the rows are units     and columns are features.</p>
<p>For more information about how PCA is implemented, visit the     <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">Scikit-Learn Documentation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or sparse matrix where rows are units/observations and columns     are features</p></li>
<li><p><strong>feature_names</strong> (<em>list</em>) – An optional list of feature names (for sparse matrices)</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of dimensions to extract</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> s, (features x components, units x components)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.dimensionality_reduction</span> <span class="k">import</span> <span class="n">get_pca</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_weights</span><span class="p">,</span> <span class="n">df_reduced</span>  <span class="o">=</span> <span class="n">get_pca</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Decomposition</span> <span class="n">explained</span> <span class="n">variance</span> <span class="n">ratio</span><span class="p">:</span> <span class="mf">0.977685206318795</span>
<span class="n">Top</span> <span class="n">features</span><span class="p">:</span>
<span class="n">Component</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">Component</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">2</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_weights</span>
      <span class="n">pca_0</span>     <span class="n">pca_1</span>
<span class="mi">0</span>  <span class="mf">0.361387</span>  <span class="mf">0.656589</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">0.084523</span>  <span class="mf">0.730161</span>
<span class="mi">2</span>  <span class="mf">0.856671</span> <span class="o">-</span><span class="mf">0.173373</span>
<span class="mi">3</span>  <span class="mf">0.358289</span> <span class="o">-</span><span class="mf">0.075481</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df_reduced</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
      <span class="n">pca_0</span>     <span class="n">pca_1</span>    <span class="n">pca</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">2.684126</span>  <span class="mf">0.319397</span>  <span class="n">pca_1</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">2.714142</span> <span class="o">-</span><span class="mf">0.177001</span>  <span class="n">pca_1</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">2.888991</span> <span class="o">-</span><span class="mf">0.144949</span>  <span class="n">pca_1</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">2.745343</span> <span class="o">-</span><span class="mf">0.318299</span>  <span class="n">pca_1</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">2.728717</span>  <span class="mf">0.326755</span>  <span class="n">pca_1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.dimensionality_reduction.get_lsa">
<code class="sig-name descname">get_lsa</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">feature_names=None</em>, <em class="sig-param">k=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/dimensionality_reduction.html#get_lsa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.dimensionality_reduction.get_lsa" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs LSA on a set of features. This function expects input data where the rows are units     and columns are features.</p>
<p>For more information about how LSA is implemented, visit the     <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html">Scikit-Learn Documentation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or sparse matrix with rows are units/observations and columns     are features</p></li>
<li><p><strong>feature_names</strong> (<em>list</em>) – An optional list of feature names (for sparse matrices)</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of dimensions to extract</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of two <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> s, (features x components, documents x components)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.dimensionality_reduction</span> <span class="k">import</span> <span class="n">get_lsa</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_weights</span><span class="p">,</span> <span class="n">df_reduced</span>  <span class="o">=</span> <span class="n">get_lsa</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Decomposition</span> <span class="n">explained</span> <span class="n">variance</span> <span class="n">ratio</span><span class="p">:</span> <span class="mf">0.9772093692426493</span>
<span class="n">Top</span> <span class="n">features</span><span class="p">:</span>
<span class="n">Component</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">Component</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">2</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_weights</span>
      <span class="n">lsa_0</span>     <span class="n">lsa_1</span>
<span class="mi">0</span>  <span class="mf">0.751108</span>  <span class="mf">0.284175</span>
<span class="mi">1</span>  <span class="mf">0.380086</span>  <span class="mf">0.546745</span>
<span class="mi">2</span>  <span class="mf">0.513009</span> <span class="o">-</span><span class="mf">0.708665</span>
<span class="mi">3</span>  <span class="mf">0.167908</span> <span class="o">-</span><span class="mf">0.343671</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df_reduced</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
      <span class="n">lsa_0</span>     <span class="n">lsa_1</span>    <span class="n">lsa</span>
<span class="mi">0</span>  <span class="mf">5.912747</span>  <span class="mf">2.302033</span>  <span class="n">lsa_0</span>
<span class="mi">1</span>  <span class="mf">5.572482</span>  <span class="mf">1.971826</span>  <span class="n">lsa_0</span>
<span class="mi">2</span>  <span class="mf">5.446977</span>  <span class="mf">2.095206</span>  <span class="n">lsa_0</span>
<span class="mi">3</span>  <span class="mf">5.436459</span>  <span class="mf">1.870382</span>  <span class="n">lsa_0</span>
<span class="mi">4</span>  <span class="mf">5.875645</span>  <span class="mf">2.328290</span>  <span class="n">lsa_0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.dimensionality_reduction.correspondence_analysis">
<code class="sig-name descname">correspondence_analysis</code><span class="sig-paren">(</span><em class="sig-param">edges</em>, <em class="sig-param">n=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/dimensionality_reduction.html#correspondence_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.dimensionality_reduction.correspondence_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs correspondence analysis on a set of features.</p>
<p>Most useful in the context of network analysis, where you might wish to, for example,     identify the underlying dimension in a network of Twitter users by using a matrix representing whether     or not they follow one another (when news and political accounts are included, the     underlying dimension often appears to approximate the left-right political spectrum.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> of NxN where both the rows and columns are “nodes” and the values     are some sort of closeness or similarity measure (like a cosine similarity matrix)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The number of dimensions to extract</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> where rows are the units and the columns correspond to the extracted     dimensions.</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.dimensionality_reduction</span> <span class="k">import</span> <span class="n">correspondence_analysis</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">linear_kernel</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;inaugural&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;speech&quot;</span><span class="p">:</span> <span class="n">fileid</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)}</span> <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="p">])</span>

<span class="n">vec</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_df</span><span class="o">=.</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="n">cosine_similarities</span> <span class="o">=</span> <span class="n">linear_kernel</span><span class="p">(</span><span class="n">tfidf</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cosine_similarities</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;speech&#39;</span><span class="p">])</span>

<span class="c1"># Looks like the main source of variation in the language of inaugural speeches is time!</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">mca</span> <span class="o">=</span> <span class="n">correspondence_analysis</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">mca</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;mca_1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                <span class="n">node</span>     <span class="n">mca_1</span>
<span class="mi">57</span>  <span class="mi">1993</span><span class="o">-</span><span class="n">Clinton</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="mf">0.075508</span>
<span class="mi">56</span>    <span class="mi">2017</span><span class="o">-</span><span class="n">Trump</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="mf">0.068168</span>
<span class="mi">55</span>  <span class="mi">1997</span><span class="o">-</span><span class="n">Clinton</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="mf">0.061567</span>
<span class="mi">54</span>    <span class="mi">1973</span><span class="o">-</span><span class="n">Nixon</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="mf">0.060698</span>
<span class="mi">53</span>     <span class="mi">1989</span><span class="o">-</span><span class="n">Bush</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="mf">0.056305</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">mca</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;mca_1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
               <span class="n">node</span>     <span class="n">mca_1</span>
<span class="mi">4</span>    <span class="mi">1877</span><span class="o">-</span><span class="n">Hayes</span><span class="o">.</span><span class="n">txt</span>  <span class="mf">0.040037</span>
<span class="mi">3</span>   <span class="mi">1817</span><span class="o">-</span><span class="n">Monroe</span><span class="o">.</span><span class="n">txt</span>  <span class="mf">0.040540</span>
<span class="mi">2</span>     <span class="mi">1845</span><span class="o">-</span><span class="n">Polk</span><span class="o">.</span><span class="n">txt</span>  <span class="mf">0.042847</span>
<span class="mi">1</span>   <span class="mi">1849</span><span class="o">-</span><span class="n">Taylor</span><span class="o">.</span><span class="n">txt</span>  <span class="mf">0.050937</span>
<span class="mi">0</span>  <span class="mi">1829</span><span class="o">-</span><span class="n">Jackson</span><span class="o">.</span><span class="n">txt</span>  <span class="mf">0.056201</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="inter-rater-reliability">
<h2>Inter-Rater Reliability<a class="headerlink" href="#inter-rater-reliability" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-pewanalytics.stats.irr" title="pewanalytics.stats.irr"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats.irr</span></code></a> submodule contains functions for computing measures of inter-rater reliability and model performance, including Cohen’s Kappa, Krippendorf’s Alpha, precision, recall, and much more.</p>
<span class="target" id="module-pewanalytics.stats.irr"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.irr.compute_overall_scores" title="pewanalytics.stats.irr.compute_overall_scores"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_overall_scores</span></code></a>(coder_df, …)</p></td>
<td><p>Computes overall inter-rater reliability scores (Krippendorf’s Alpha and Fleiss’ Kappa).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.irr.compute_scores" title="pewanalytics.stats.irr.compute_scores"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_scores</span></code></a>(coder_df, coder1, coder2, …)</p></td>
<td><p>Computes a variety of inter-rater reliability scores, including Cohen’s kappa, Krippendorf’s alpha, precision, and recall.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.irr.kappa_sample_size_CI" title="pewanalytics.stats.irr.kappa_sample_size_CI"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kappa_sample_size_CI</span></code></a>(kappa0, kappaL, props)</p></td>
<td><p>Helps determine the required document sample size to confirm that Cohen’s Kappa between coders is at or     above a minimum threhsold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.irr.kappa_sample_size_power" title="pewanalytics.stats.irr.kappa_sample_size_power"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kappa_sample_size_power</span></code></a>(rate1, rate2, k1, k0)</p></td>
<td><p>Python translation of the <code class="docutils literal notranslate"><span class="pre">N.cohen.kappa</span></code> function from the <code class="docutils literal notranslate"><span class="pre">irr</span></code> R package.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pewanalytics.stats.irr.kappa_sample_size_power">
<code class="sig-name descname">kappa_sample_size_power</code><span class="sig-paren">(</span><em class="sig-param">rate1</em>, <em class="sig-param">rate2</em>, <em class="sig-param">k1</em>, <em class="sig-param">k0</em>, <em class="sig-param">alpha=0.05</em>, <em class="sig-param">power=0.8</em>, <em class="sig-param">twosided=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/irr.html#kappa_sample_size_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.irr.kappa_sample_size_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Python translation of the <code class="docutils literal notranslate"><span class="pre">N.cohen.kappa</span></code> function from the <code class="docutils literal notranslate"><span class="pre">irr</span></code> R package.</p>
<p>Source: <a class="reference external" href="https://cran.r-project.org/web/packages/irr/irr.pdf">https://cran.r-project.org/web/packages/irr/irr.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rate1</strong> (<em>float</em>) – The probability that the first rater will record a positive diagnosis</p></li>
<li><p><strong>rate2</strong> (<em>float</em>) – The probability that the second rater will record a positive diagnosis</p></li>
<li><p><strong>k1</strong> (<em>float</em>) – The true Cohen’s Kappa statistic</p></li>
<li><p><strong>k0</strong> (<em>float</em>) – The value of kappa under the null hypothesis</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Type I error of test</p></li>
<li><p><strong>power</strong> (<em>float</em>) – The desired power to detect the difference between true kappa and hypothetical kappa</p></li>
<li><p><strong>twosided</strong> – Set this to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the test is two-sided</p></li>
<li><p><strong>twosided</strong> – bool</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the required sample size</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.irr.kappa_sample_size_CI">
<code class="sig-name descname">kappa_sample_size_CI</code><span class="sig-paren">(</span><em class="sig-param">kappa0</em>, <em class="sig-param">kappaL</em>, <em class="sig-param">props</em>, <em class="sig-param">kappaU=None</em>, <em class="sig-param">alpha=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/irr.html#kappa_sample_size_CI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.irr.kappa_sample_size_CI" title="Permalink to this definition">¶</a></dt>
<dd><p>Helps determine the required document sample size to confirm that Cohen’s Kappa between coders is at or     above a minimum threhsold. Useful in situations where multiple coders code a set of documents for a binary outcome.</p>
<p>This function takes the observed kappa and proportion of positive cases from the sample, along with a lower-bound     for the minimum acceptable kappa, and returns the sample size required to confirm that the coders’ agreement is     truly above that minimum level of kappa with 95% certainty. If the current sample size is below the required     sample size returned by this function, it can provide a rough estimate of how many additional documents need     to be coded - assuming that the coders continue agreeing and observing positive cases at the same rate.</p>
<p>Translated from the <code class="docutils literal notranslate"><span class="pre">kappaSize</span></code> R package, <code class="docutils literal notranslate"><span class="pre">CIBinary</span></code>:     <a class="reference external" href="https://github.com/cran/kappaSize/blob/master/R/CIBinary.R">https://github.com/cran/kappaSize/blob/master/R/CIBinary.R</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kappa0</strong> – The preliminary value of kappa</p></li>
<li><p><strong>kappa0</strong> – float</p></li>
<li><p><strong>kappaL</strong> (<em>float</em>) – The desired expected lower bound for a two-sided 100(1 - alpha) % confidence interval for kappa.     Alternatively, if kappaU is set to NA, the procedure produces the number of required subjects for a one-sided     confidence interval</p></li>
<li><p><strong>props</strong> (<em>float</em>) – The anticipated prevalence of the desired trait</p></li>
<li><p><strong>kappaU</strong> (<em>float</em>) – The desired expected upper confidence limit for kappa</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The desired type I error rate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the required sample size</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.irr</span> <span class="k">import</span> <span class="n">kappa_sample_size_CI</span>

<span class="n">observed_kappa</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">desired_kappa</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">observed_proportion</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">kappa_sample_size</span><span class="p">(</span><span class="n">observed_kappa</span><span class="p">,</span> <span class="n">desired_kappa</span><span class="p">,</span> <span class="n">observed_proportion</span><span class="p">)</span>
<span class="mi">140</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.irr.compute_scores">
<code class="sig-name descname">compute_scores</code><span class="sig-paren">(</span><em class="sig-param">coder_df</em>, <em class="sig-param">coder1</em>, <em class="sig-param">coder2</em>, <em class="sig-param">outcome_column</em>, <em class="sig-param">document_column</em>, <em class="sig-param">coder_column</em>, <em class="sig-param">weight_column=None</em>, <em class="sig-param">pos_label=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/irr.html#compute_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.irr.compute_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a variety of inter-rater reliability scores, including Cohen’s kappa, Krippendorf’s alpha, precision,
and recall. The input data must consist of a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p>A column with values that indicate the coder (like a name)</p></li>
<li><p>A column with values that indicate the document (like an ID)</p></li>
<li><p>A column with values that indicate the code value</p></li>
<li><p>(Optional) A column with document weights</p></li>
</ul>
</div></blockquote>
<p>This function will return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with agreement scores between the two specified coders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coder_df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> of codes</p></li>
<li><p><strong>coder1</strong> (<em>str</em><em> or </em><em>int</em>) – The value in <code class="docutils literal notranslate"><span class="pre">coder_column</span></code> for rows corresponding to the first coder</p></li>
<li><p><strong>coder2</strong> (<em>str</em><em> or </em><em>int</em>) – The value in <code class="docutils literal notranslate"><span class="pre">coder_column</span></code> for rows corresponding to the second coder</p></li>
<li><p><strong>outcome_column</strong> (<em>str</em>) – The column that contains the codes</p></li>
<li><p><strong>document_column</strong> (<em>str</em>) – The column that contains IDs for the documents</p></li>
<li><p><strong>coder_column</strong> (<em>str</em>) – The column containing values that indicate which coder assigned the code</p></li>
<li><p><strong>weight_column</strong> (<em>str</em>) – The column that contains sampling weights</p></li>
<li><p><strong>pos_label</strong> (<em>str</em><em> or </em><em>int</em>) – The value indicating a positive label (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If using a multi-class (non-binary) code, some scores may come back null or not compute as expected.         We recommend running the function separately for each specific code value as a binary flag by providing         each unique value to the <code class="docutils literal notranslate"><span class="pre">pos_label</span></code> argument. If <code class="docutils literal notranslate"><span class="pre">pos_label</span></code> is not provided for multi-class codes,         this function will attempt to compute scores based on support-weighted averages.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.irr</span> <span class="k">import</span> <span class="n">compute_scores</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
<span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">compute_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span> <span class="s2">&quot;coder&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;coder1&#39;</span><span class="p">:</span> <span class="s1">&#39;coder1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder2&#39;</span><span class="p">:</span> <span class="s1">&#39;coder2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;outcome_column&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pos_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;coder1_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;coder1_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.5773502691896257</span><span class="p">,</span>
 <span class="s1">&#39;coder2_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">1.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder2_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;alpha_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.5454545454545454</span><span class="p">,</span>
 <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="mf">0.5555555555555555</span><span class="p">,</span>
 <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;precision_recall_min&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;matthews_corrcoef&#39;</span><span class="p">:</span> <span class="mf">0.6123724356957946</span><span class="p">,</span>
 <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;pct_agree_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">compute_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span> <span class="s2">&quot;coder&quot;</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
 <span class="p">{</span><span class="s1">&#39;coder1&#39;</span><span class="p">:</span> <span class="s1">&#39;coder1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder2&#39;</span><span class="p">:</span> <span class="s1">&#39;coder2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;outcome_column&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pos_label&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder1_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder1_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder2_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder2_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;alpha_unweighted&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;cohens_kappa&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;precision_recall_min&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;matthews_corrcoef&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;pct_agree_unweighted&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">compute_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span> <span class="s2">&quot;coder&quot;</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;coder1&#39;</span><span class="p">:</span> <span class="s1">&#39;coder1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder2&#39;</span><span class="p">:</span> <span class="s1">&#39;coder2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;outcome_column&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pos_label&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder1_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder1_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder2_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;coder2_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;alpha_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;cohens_kappa&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;precision_recall_min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;matthews_corrcoef&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;pct_agree_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">compute_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span> <span class="s2">&quot;coder&quot;</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;coder1&#39;</span><span class="p">:</span> <span class="s1">&#39;coder1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder2&#39;</span><span class="p">:</span> <span class="s1">&#39;coder2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;outcome_column&#39;</span><span class="p">:</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pos_label&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;coder1_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder1_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;coder2_mean_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;coder2_std_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span>
 <span class="s1">&#39;alpha_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.4444444444444444</span><span class="p">,</span>
 <span class="s1">&#39;cohens_kappa&#39;</span><span class="p">:</span> <span class="mf">0.3999999999999999</span><span class="p">,</span>
 <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span>
 <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;precision_recall_min&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;matthews_corrcoef&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
 <span class="s1">&#39;pct_agree_unweighted&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.irr.compute_overall_scores">
<code class="sig-name descname">compute_overall_scores</code><span class="sig-paren">(</span><em class="sig-param">coder_df</em>, <em class="sig-param">document_column</em>, <em class="sig-param">outcome_column</em>, <em class="sig-param">coder_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/irr.html#compute_overall_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.irr.compute_overall_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes overall inter-rater reliability scores (Krippendorf’s Alpha and Fleiss’ Kappa). Allows for more than two     coders and code values. The input data must consist of a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p>A column with values that indicate the coder (like a name)</p></li>
<li><p>A column with values that indicate the document (like an ID)</p></li>
<li><p>A column with values that indicate the code value</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coder_df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> of codes</p></li>
<li><p><strong>document_column</strong> (<em>str</em>) – The column that contains IDs for the documents</p></li>
<li><p><strong>outcome_column</strong> (<em>str</em>) – The column that contains the codes</p></li>
<li><p><strong>coder_column</strong> (<em>str</em>) – The column containing values that indicate which coder assigned the code</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.irr</span> <span class="k">import</span> <span class="n">compute_overall_scores</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder1&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;coder&quot;</span><span class="p">:</span> <span class="s2">&quot;coder2&quot;</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">},</span>
<span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">compute_overall_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;document&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;coder&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="s1">&#39;fleiss_kappa&#39;</span><span class="p">:</span> <span class="mf">0.4545454545454544</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="mutual-information">
<h2>Mutual Information<a class="headerlink" href="#mutual-information" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-pewanalytics.stats.mutual_info" title="pewanalytics.stats.mutual_info"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info</span></code></a> submodule provides a function for extracting pointwise mutual information for features in your data based on a binary split into two classes. This can be a great method for identifying features that are most distinctive of one group versus another.</p>
<span class="target" id="module-pewanalytics.stats.mutual_info"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_mutual_info</span></code></a>(y, x[, weights, …])</p></td>
<td><p>Computes pointwise mutual information for a set of observations partitioned into two groups.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.mutual_info.mutual_info_bar_plot" title="pewanalytics.stats.mutual_info.mutual_info_bar_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mutual_info_bar_plot</span></code></a>(mutual_info[, …])</p></td>
<td><p>Takes a mutual information table generated by <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a>,     and generates a bar plot of top features.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.mutual_info.mutual_info_scatter_plot" title="pewanalytics.stats.mutual_info.mutual_info_scatter_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mutual_info_scatter_plot</span></code></a>(mutual_info[, …])</p></td>
<td><p>Takes a mutual information table generated by <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a>,     and generates a scatter plot of top features.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pewanalytics.stats.mutual_info.compute_mutual_info">
<code class="sig-name descname">compute_mutual_info</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">x</em>, <em class="sig-param">weights=None</em>, <em class="sig-param">col_names=None</em>, <em class="sig-param">l=0</em>, <em class="sig-param">normalize=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/mutual_info.html#compute_mutual_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes pointwise mutual information for a set of observations partitioned into two groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – An array or, preferably, a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></p></li>
<li><p><strong>x</strong> – A matrix, <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, or preferably a <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></p></li>
<li><p><strong>weights</strong> – (Optional) An array of weights corresponding to each observation</p></li>
<li><p><strong>col_names</strong> (<em>list</em>) – The feature names associated with the columns in matrix ‘x’</p></li>
<li><p><strong>l</strong> (<em>int</em><em> or </em><em>float</em>) – An optional Laplace smoothing parameter</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Toggle normalization on or off (to control for feature prevalance), on by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> of features with a variety of computed metrics including mutual information.</p>
</dd>
</dl>
<p>The function expects <code class="docutils literal notranslate"><span class="pre">y</span></code> to correspond to a list or series of values indicating which partition an observation     belongs to. <code class="docutils literal notranslate"><span class="pre">y</span></code> must be a binary flag. <code class="docutils literal notranslate"><span class="pre">x</span></code> is a set of features (either a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> or     sparse matrix) where the rows correspond to observations and the columns represent the presence of features (you     can technically run this using non-binary features but the results will not be as readily interpretable.) The     function returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> of metrics computed for each feature, including the following     columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MI1</span></code>: The feature’s mutual information for the positive class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MI0</span></code>: The feature’s mutual information for the negative class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: The total number of times a feature appeared</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_pos_with_term</span></code>: The total number of times a feature appeared in positive cases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_neg_with_term</span></code>: The total number of times a feature appeared in negative cases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_pos_neg_with_term_diff</span></code>: The raw difference in the number of times a feature appeared in positive cases     relative to negative cases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_pos_with_term</span></code>: The proportion of positive cases that had the feature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_neg_with_term</span></code>: The proportion of negative cases that had the feature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_pos_neg_with_term_ratio</span></code>: A likelihood ratio indicating the degree to which a positive case was more likely     to have the feature than a negative case</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_term_pos</span></code>: Of the cases that had a feature, the proportion that were in the positive class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_term_neg</span></code>: Of the cases that had a feature, the proportion that were in the negative class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_term_pos_neg_diff</span></code>: The percentage point difference between the proportion of cases with the feature that     were positive vs. negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pct_term_pos_neg_ratio</span></code>: A likelihood ratio indicating the degree to which a feature was more likely to appear     in a positive case relative to a negative one (may not be meaningful when classes are imbalanced)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">pct_term_pos</span></code> and <code class="docutils literal notranslate"><span class="pre">pct_term_neg</span></code> may not be directly comparable if classes are imbalanced,         and in such cases a <code class="docutils literal notranslate"><span class="pre">pct_term_pos_neg_diff</span></code> above zero or <code class="docutils literal notranslate"><span class="pre">pct_term_pos_neg_ratio</span></code> above 1 may not indicate a         true association with the positive class if positive cases outnumber negative ones.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mutual information can be a difficult metric to explain to others. We’ve found that the         <code class="docutils literal notranslate"><span class="pre">pct_pos_neg_with_term_ratio</span></code> can serve as a more interpretable alternative method for identifying         meaningful differences between groups.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.mutual_info</span> <span class="k">import</span> <span class="n">compute_mutual_info</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">linear_kernel</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;inaugural&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;speech&quot;</span><span class="p">:</span> <span class="n">fileid</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)}</span> <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;speech&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;21st_century&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">2000</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vec</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_df</span><span class="o">=.</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="c1"># Here are the terms most distinctive of inaugural addresses in the 21st century vs. years prior</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">compute_mutual_info</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;21st_century&#39;</span><span class="p">],</span> <span class="n">tfidf</span><span class="p">,</span> <span class="n">col_names</span><span class="o">=</span><span class="n">vec</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;MI1&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span>
<span class="n">Index</span><span class="p">([</span><span class="s1">&#39;america&#39;</span><span class="p">,</span> <span class="s1">&#39;thank&#39;</span><span class="p">,</span> <span class="s1">&#39;bless&#39;</span><span class="p">,</span> <span class="s1">&#39;schools&#39;</span><span class="p">,</span> <span class="s1">&#39;ideals&#39;</span><span class="p">,</span> <span class="s1">&#39;americans&#39;</span><span class="p">,</span>
       <span class="s1">&#39;meaning&#39;</span><span class="p">,</span> <span class="s1">&#39;you&#39;</span><span class="p">,</span> <span class="s1">&#39;move&#39;</span><span class="p">,</span> <span class="s1">&#39;across&#39;</span><span class="p">,</span> <span class="s1">&#39;courage&#39;</span><span class="p">,</span> <span class="s1">&#39;child&#39;</span><span class="p">,</span> <span class="s1">&#39;birth&#39;</span><span class="p">,</span>
       <span class="s1">&#39;generation&#39;</span><span class="p">,</span> <span class="s1">&#39;families&#39;</span><span class="p">,</span> <span class="s1">&#39;build&#39;</span><span class="p">,</span> <span class="s1">&#39;hard&#39;</span><span class="p">,</span> <span class="s1">&#39;promise&#39;</span><span class="p">,</span> <span class="s1">&#39;choice&#39;</span><span class="p">,</span> <span class="s1">&#39;women&#39;</span><span class="p">,</span>
       <span class="s1">&#39;guided&#39;</span><span class="p">,</span> <span class="s1">&#39;words&#39;</span><span class="p">,</span> <span class="s1">&#39;blood&#39;</span><span class="p">,</span> <span class="s1">&#39;dignity&#39;</span><span class="p">,</span> <span class="s1">&#39;because&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.mutual_info.mutual_info_bar_plot">
<code class="sig-name descname">mutual_info_bar_plot</code><span class="sig-paren">(</span><em class="sig-param">mutual_info</em>, <em class="sig-param">filter_col='MI1'</em>, <em class="sig-param">top_n=50</em>, <em class="sig-param">x_col='pct_term_pos_neg_ratio'</em>, <em class="sig-param">color='grey'</em>, <em class="sig-param">title=None</em>, <em class="sig-param">width=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/mutual_info.html#mutual_info_bar_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.mutual_info.mutual_info_bar_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a mutual information table generated by <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a>,     and generates a bar plot of top features. Allows for an easy visualization of feature differences. Can     subsequently call <code class="xref py py-func docutils literal notranslate"><span class="pre">plt.show()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">plt.savefig()</span></code> to display or save the plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mutual_info</strong> – A mutual information table generated by     <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a></p></li>
<li><p><strong>filter_col</strong> (<em>str</em>) – The column to use when selecting top features; sorts in descending order and picks the     top <code class="docutils literal notranslate"><span class="pre">top_n</span></code></p></li>
<li><p><strong>top_n</strong> (<em>int</em>) – The number of features to display</p></li>
<li><p><strong>x_col</strong> (<em>str</em>) – The column by which to sort the final set of top features (after they have been selected by     <code class="docutils literal notranslate"><span class="pre">filter_col</span></code></p></li>
<li><p><strong>color</strong> (<em>str</em>) – The color of the bars</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title of the plot</p></li>
<li><p><strong>width</strong> (<em>int</em>) – The width of the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Matplotlib figure, which you can display via <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> or alternatively save to a file via     <code class="docutils literal notranslate"><span class="pre">plt.savefig(FILEPATH)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.mutual_info.mutual_info_scatter_plot">
<code class="sig-name descname">mutual_info_scatter_plot</code><span class="sig-paren">(</span><em class="sig-param">mutual_info</em>, <em class="sig-param">filter_col='MI1'</em>, <em class="sig-param">top_n=50</em>, <em class="sig-param">x_col='pct_term_pos_neg_ratio'</em>, <em class="sig-param">xlabel=None</em>, <em class="sig-param">scale_x_even=True</em>, <em class="sig-param">y_col='MI1'</em>, <em class="sig-param">ylabel=None</em>, <em class="sig-param">scale_y_even=True</em>, <em class="sig-param">color='grey'</em>, <em class="sig-param">color_col='MI1'</em>, <em class="sig-param">size_col='pct_pos_with_term'</em>, <em class="sig-param">title=None</em>, <em class="sig-param">figsize=(10</em>, <em class="sig-param">10)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/mutual_info.html#mutual_info_scatter_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.mutual_info.mutual_info_scatter_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a mutual information table generated by <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a>,     and generates a scatter plot of top features.
The names of the features will be displayed with varying colors and sizes depending on the variables specified
in <code class="docutils literal notranslate"><span class="pre">color_col</span></code> and <code class="docutils literal notranslate"><span class="pre">size_col</span></code>. Allows for an easy visualization of feature differences. Can subsequently
call <code class="xref py py-func docutils literal notranslate"><span class="pre">plt.show()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">plt.savefig()</span></code> to display or save the plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mutual_info</strong> – A mutual information table generated by     <a class="reference internal" href="#pewanalytics.stats.mutual_info.compute_mutual_info" title="pewanalytics.stats.mutual_info.compute_mutual_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pewanalytics.stats.mutual_info.compute_mutual_info()</span></code></a></p></li>
<li><p><strong>filter_col</strong> (<em>str</em>) – The column to use when selecting top features; sorts in descending order and picks the top     <code class="docutils literal notranslate"><span class="pre">top_n</span></code></p></li>
<li><p><strong>top_n</strong> (<em>int</em>) – The number of features to display</p></li>
<li><p><strong>x_col</strong> (<em>str</em>) – The column to use as the x-axis</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – Label for the x-axis</p></li>
<li><p><strong>scale_x_even</strong> (<em>bool</em>) – If True, set values to their ordered rank (allows for even spacing)</p></li>
<li><p><strong>y_col</strong> (<em>str</em>) – The column to use as the y-axis</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – Label for the y-axis</p></li>
<li><p><strong>scale_y_even</strong> (<em>bool</em>) – If True, set values to their ordered rank (allows for even spacing)</p></li>
<li><p><strong>color</strong> (<em>str</em>) – The color for the features</p></li>
<li><p><strong>color_col</strong> (<em>str</em>) – The column to use when shading the features</p></li>
<li><p><strong>size_col</strong> (<em>str</em>) – The column to use to size the features</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title of the plot</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em>) – The size of the plot (tuple)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Matplotlib figure, which you can display via <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> or alternatively save to a file via     <code class="docutils literal notranslate"><span class="pre">plt.savefig(FILEPATH)</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-pewanalytics.stats.sampling" title="pewanalytics.stats.sampling"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pewanalytics.stats.sampling</span></code></a> submodule contains utilities for extracting and weighting samples based on a known sampling frame.</p>
<span class="target" id="module-pewanalytics.stats.sampling"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.sampling.SampleExtractor" title="pewanalytics.stats.sampling.SampleExtractor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SampleExtractor</span></code></a>(df, id_col[, verbose, seed])</p></td>
<td><p>A helper class for extracting samples using various sampling methods.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.sampling.compute_balanced_sample_weights" title="pewanalytics.stats.sampling.compute_balanced_sample_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_balanced_sample_weights</span></code></a>(sample, …)</p></td>
<td><p>Takes a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> and one or more column names (<code class="docutils literal notranslate"><span class="pre">weight_vars</span></code>) and computes weights such     that every unique combination of values in the weighting columns are balanced (when weighted, the sum of the     observations with each combination will be equal to one another).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pewanalytics.stats.sampling.compute_sample_weights_from_frame" title="pewanalytics.stats.sampling.compute_sample_weights_from_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_sample_weights_from_frame</span></code></a>(frame, …)</p></td>
<td><p>Takes two <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> s and computes sampling weights for the second one, based on the first.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pewanalytics.stats.sampling.compute_sample_weights_from_frame">
<code class="sig-name descname">compute_sample_weights_from_frame</code><span class="sig-paren">(</span><em class="sig-param">frame</em>, <em class="sig-param">sample</em>, <em class="sig-param">weight_vars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/sampling.html#compute_sample_weights_from_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.sampling.compute_sample_weights_from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes two <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> s and computes sampling weights for the second one, based on the first.     The first <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> should be equivalent to the population that the second     <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, a sample, was drawn from. Weights will be calculated based on the differences in     the distribution of one or more variables specified in <code class="docutils literal notranslate"><span class="pre">weight_vars</span></code> (these should be the names of columns).     Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> equal in length to the <code class="docutils literal notranslate"><span class="pre">sample</span></code> with the computed weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> (must contain all of the columns specified in <code class="docutils literal notranslate"><span class="pre">weight_vars</span></code>)</p></li>
<li><p><strong>sample</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> (must contain all of the columns specified in <code class="docutils literal notranslate"><span class="pre">weight_vars</span></code>)</p></li>
<li><p><strong>weight_vars</strong> (<em>list</em>) – The names of the columns to use when computing weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> containing the weights for each row in the <code class="docutils literal notranslate"><span class="pre">sample</span></code></p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.sampling</span> <span class="k">import</span> <span class="n">compute_sample_weights_from_frame</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">linear_kernel</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;inaugural&quot;</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;speech&quot;</span><span class="p">:</span> <span class="n">fileid</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)}</span> <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="p">])</span>
<span class="c1"># Let&#39;s grab a sample of speeches - some that mention specific terms, and an additional random sample</span>
<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;economy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;economy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;health&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;health&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;immigration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;immigration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;education&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s1">&#39;economy&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s1">&#39;health&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s1">&#39;immigration&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">frame</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="p">])</span>
<span class="c1"># Now we can get the sampling weights to adjust it back to the population based on those variables</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_sample_weights_from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;economy&quot;</span><span class="p">,</span> <span class="s2">&quot;health&quot;</span><span class="p">,</span> <span class="s2">&quot;immigration&quot;</span><span class="p">,</span> <span class="s2">&quot;education&quot;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sample</span>
               <span class="n">speech</span>                                               <span class="n">text</span>  <span class="n">economy</span>  <span class="n">health</span>  <span class="n">immigration</span>  <span class="n">education</span>  <span class="n">count</span>    <span class="n">weight</span>
<span class="mi">7</span>     <span class="mi">1817</span><span class="o">-</span><span class="n">Monroe</span><span class="o">.</span><span class="n">txt</span>  <span class="n">I</span> <span class="n">should</span> <span class="n">be</span> <span class="n">destitute</span> <span class="n">of</span> <span class="n">feeling</span> <span class="k">if</span> <span class="n">I</span> <span class="n">was</span> <span class="ow">not</span> <span class="o">...</span>        <span class="mi">1</span>       <span class="mi">1</span>            <span class="mi">0</span>          <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">1.005747</span>
<span class="mi">11</span>   <span class="mi">1833</span><span class="o">-</span><span class="n">Jackson</span><span class="o">.</span><span class="n">txt</span>  <span class="n">Fellow</span> <span class="n">citizens</span><span class="p">,</span> <span class="n">the</span> <span class="n">will</span> <span class="n">of</span> <span class="n">the</span> <span class="n">American</span> <span class="n">peop</span><span class="o">...</span>        <span class="mi">1</span>       <span class="mi">0</span>            <span class="mi">0</span>          <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">2.370690</span>
<span class="mi">34</span>  <span class="mi">1925</span><span class="o">-</span><span class="n">Coolidge</span><span class="o">.</span><span class="n">txt</span>  <span class="n">My</span> <span class="n">countrymen</span><span class="p">,</span> <span class="n">no</span> <span class="n">one</span> <span class="n">can</span> <span class="n">contemplate</span> <span class="n">curre</span><span class="o">...</span>           <span class="mi">1</span>       <span class="mi">0</span>            <span class="mi">1</span>          <span class="mi">1</span>      <span class="mi">1</span>  <span class="mf">0.344828</span>
<span class="mi">35</span>    <span class="mi">1929</span><span class="o">-</span><span class="n">Hoover</span><span class="o">.</span><span class="n">txt</span>  <span class="n">My</span> <span class="n">Countrymen</span><span class="p">:</span> <span class="n">This</span> <span class="n">occasion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">alone</span> <span class="n">the</span> <span class="o">...</span>        <span class="mi">1</span>       <span class="mi">1</span>            <span class="mi">0</span>          <span class="mi">1</span>      <span class="mi">1</span>  <span class="mf">0.538793</span>
<span class="mi">28</span>  <span class="mi">1901</span><span class="o">-</span><span class="n">McKinley</span><span class="o">.</span><span class="n">txt</span>  <span class="n">My</span> <span class="n">fellow</span><span class="o">-</span><span class="n">citizens</span><span class="p">,</span> <span class="n">when</span> <span class="n">we</span> <span class="n">assembled</span> <span class="n">here</span> <span class="n">on</span> <span class="o">...</span>        <span class="mi">1</span>       <span class="mi">0</span>            <span class="mi">0</span>          <span class="mi">0</span>      <span class="mi">1</span>  <span class="mf">2.370690</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pewanalytics.stats.sampling.compute_balanced_sample_weights">
<code class="sig-name descname">compute_balanced_sample_weights</code><span class="sig-paren">(</span><em class="sig-param">sample</em>, <em class="sig-param">weight_vars</em>, <em class="sig-param">weight_column=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/sampling.html#compute_balanced_sample_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.sampling.compute_balanced_sample_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> and one or more column names (<code class="docutils literal notranslate"><span class="pre">weight_vars</span></code>) and computes weights such     that every unique combination of values in the weighting columns are balanced (when weighted, the sum of the     observations with each combination will be equal to one another). Useful for balancing important groups in     training datasets, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> (must contain all of the columns specified in <code class="docutils literal notranslate"><span class="pre">weight_vars</span></code>)</p></li>
<li><p><strong>weight_vars</strong> (<em>list</em>) – The names of the columns to use when computing weights.</p></li>
<li><p><strong>weight_column</strong> (<em>str</em>) – An option column containing existing weights, which can be factored into the new weights.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code> containing the weights for each row in the <code class="docutils literal notranslate"><span class="pre">sample</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All weight variables must be binary flags (1 or 0); if you want to weight using a non-binary variable,         you should convert it into a set of dummy variables and then pass those in as multiple columns.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.sampling</span> <span class="k">import</span> <span class="n">compute_balanced_sample_weights</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Let&#39;s say we have a set of tweets from members of Congress</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;politician_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;Example document&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;politician_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;Example document&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;politician_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;Example document&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;politician_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;Example document&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;politician_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;Example document&quot;</span><span class="p">},</span>
<span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_republican&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;R&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># We can balance the parties like so:</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_balanced_sample_weights</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;is_republican&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span>
   <span class="n">politician_id</span> <span class="n">party</span>             <span class="n">tweet</span>  <span class="n">is_rep</span>    <span class="n">weight</span>  <span class="n">is_republican</span>
<span class="mi">0</span>              <span class="mi">1</span>     <span class="n">R</span>  <span class="n">Example</span> <span class="n">document</span>       <span class="mi">1</span>  <span class="mf">1.250000</span>              <span class="mi">1</span>
<span class="mi">1</span>              <span class="mi">1</span>     <span class="n">R</span>  <span class="n">Example</span> <span class="n">document</span>       <span class="mi">1</span>  <span class="mf">1.250000</span>              <span class="mi">1</span>
<span class="mi">2</span>              <span class="mi">2</span>     <span class="n">D</span>  <span class="n">Example</span> <span class="n">document</span>       <span class="mi">0</span>  <span class="mf">0.833333</span>              <span class="mi">0</span>
<span class="mi">3</span>              <span class="mi">2</span>     <span class="n">D</span>  <span class="n">Example</span> <span class="n">document</span>       <span class="mi">0</span>  <span class="mf">0.833333</span>              <span class="mi">0</span>
<span class="mi">4</span>              <span class="mi">3</span>     <span class="n">D</span>  <span class="n">Example</span> <span class="n">document</span>       <span class="mi">0</span>  <span class="mf">0.833333</span>              <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="pewanalytics.stats.sampling.SampleExtractor">
<em class="property">class </em><code class="sig-name descname">SampleExtractor</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">id_col</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/sampling.html#SampleExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.sampling.SampleExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper class for extracting samples using various sampling methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) – The sampling frame</p></li>
<li><p><strong>id_col</strong> (<em>str</em>) – Column in the <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> to be used as the unique ID of observations</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether or not to print information during the sampling process (default=False)</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed (optional)</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pewanalytics.stats.sampling.SampleExtractor.extract" title="pewanalytics.stats.sampling.SampleExtractor.extract"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract</span></code></a>(sample_size[, sampling_strategy, …])</p></td>
<td><p>Extract a sample from a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> using one of the following methods:</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pewanalytics.stats.sampling.SampleExtractor.extract">
<code class="sig-name descname">extract</code><span class="sig-paren">(</span><em class="sig-param">sample_size</em>, <em class="sig-param">sampling_strategy='random'</em>, <em class="sig-param">stratify_by=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pewanalytics/stats/sampling.html#SampleExtractor.extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pewanalytics.stats.sampling.SampleExtractor.extract" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a sample from a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> using one of the following methods:</p>
<ul class="simple">
<li><p>all: Returns all of the IDs</p></li>
<li><p>random: Returns a random sample</p></li>
<li><p>stratify: Proportional stratification, method from Kish, Leslie. “Survey sampling.” (1965). Chapter 4.</p></li>
<li><p>stratify_even: Sample evenly from each strata (will obviously not be representative)</p></li>
<li><p>stratify_guaranteed: Proportional stratification, but the sample is guaranteed to contain at least one             observation from each strata (if sample size is small and/or there are many small strata, the resulting             sample may be far from representative)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_size</strong> (<em>int</em>) – The desired size of the sample</p></li>
<li><p><strong>sampling_strategy</strong> (<em>str</em>) – The method to be used to extract samples. Options are: all, random, stratify,         stratify_even, stratify_guaranteed</p></li>
<li><p><strong>stratify_by</strong> (<em>str</em><em>, </em><em>list</em>) – Optional name of a column or list of columns in the <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> to         stratify on</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of IDs reflecting the observations selected from the <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> during         sampling</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pewanalytics.stats.sampling</span> <span class="k">import</span> <span class="n">SampleExtractor</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">linear_kernel</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;inaugural&quot;</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;speech&quot;</span><span class="p">:</span> <span class="n">fileid</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileid</span><span class="p">)}</span> <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">inaugural</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="p">])</span>
<span class="n">frame</span><span class="p">[</span><span class="s2">&quot;century&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;speech&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">00&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sampler</span> <span class="o">=</span> <span class="n">SampleExtractor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;speech&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sample_index</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">)</span>
<span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;speech&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample_index</span><span class="p">)][</span><span class="s1">&#39;century&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1900</span>    <span class="mi">6</span>
<span class="mi">1800</span>    <span class="mi">5</span>
<span class="mi">1700</span>    <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">century</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sample_index</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="o">=</span><span class="s2">&quot;stratify&quot;</span><span class="p">,</span> <span class="n">stratify_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;century&#39;</span><span class="p">])</span>
<span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;speech&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample_index</span><span class="p">)][</span><span class="s1">&#39;century&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1800</span>    <span class="mi">5</span>
<span class="mi">1900</span>    <span class="mi">5</span>
<span class="mi">2000</span>    <span class="mi">1</span>
<span class="mi">1700</span>    <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">century</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sample_index</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="o">=</span><span class="s2">&quot;stratify_even&quot;</span><span class="p">,</span> <span class="n">stratify_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;century&#39;</span><span class="p">])</span>
<span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;speech&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample_index</span><span class="p">)][</span><span class="s1">&#39;century&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1800</span>    <span class="mi">3</span>
<span class="mi">2000</span>    <span class="mi">3</span>
<span class="mi">1700</span>    <span class="mi">3</span>
<span class="mi">1900</span>    <span class="mi">3</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">century</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sample_index</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="o">=</span><span class="s2">&quot;stratify_guaranteed&quot;</span><span class="p">,</span> <span class="n">stratify_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;century&#39;</span><span class="p">])</span>
<span class="n">frame</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;speech&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sample_index</span><span class="p">)][</span><span class="s1">&#39;century&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="mi">1900</span>    <span class="mi">5</span>
<span class="mi">1800</span>    <span class="mi">4</span>
<span class="mi">1700</span>    <span class="mi">2</span>
<span class="mi">2000</span>    <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">century</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="text.html" class="btn btn-neutral float-right" title="pewanalytics.text: Text Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Pew Analytics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Pew Research Center

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>